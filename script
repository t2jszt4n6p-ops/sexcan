# Tüm çalıştır geçmişini temizler
# Bu yöntem daha basit ve garantili

$registryPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU"

if (Test-Path $registryPath) {
    Write-Host "Çalıştır geçmişi temizleniyor..." -ForegroundColor Yellow
    
    # Tüm değerleri al
    $values = Get-ItemProperty -Path $registryPath
    
    # MRUList hariç tüm değerleri sil
    foreach ($property in $values.PSObject.Properties) {
        if ($property.Name -ne "MRUList" -and $property.Name -ne "PSPath" -and $property.Name -ne "PSParentPath" -and $property.Name -ne "PSChildName" -and $property.Name -ne "PSDrive" -and $property.Name -ne "PSProvider") {
            Remove-ItemProperty -Path $registryPath -Name $property.Name -ErrorAction SilentlyContinue
        }
    }
    
    # MRUList'i boş olarak güncelle
    Set-ItemProperty -Path $registryPath -Name "MRUList" -Value ""
    
    Write-Host "Çalıştır geçmişi temizlendi!" -ForegroundColor Green
    
    # Değişikliklerin etkili olması için Explorer'ı yeniden başlatma seçeneği
    $restartExplorer = Read-Host "Değişikliklerin etkili olması için Explorer'ı yeniden başlatmak ister misiniz? (E/H)"
    
    if ($restartExplorer -eq "E" -or $restartExplorer -eq "e") {
        Stop-Process -Name explorer -Force
        Start-Process explorer
        Write-Host "Explorer yeniden başlatıldı." -ForegroundColor Green
    }
} else {
    Write-Host "Çalıştır geçmişi bulunamadı." -ForegroundColor Red
}
